# Extremal -- Polynomial Solution

## Governing differential equation

From the [optimizing equations](./extremal.md):

Using our formula for \\(F\\):

\\[f\times (L-f) = C\sqrt{1-{f'}\^2}\\]

or

\\[f\^2\times (L-f)\^2 - C\^2\times(1-{f'}\^2)=0\\]

Endpoints: \\[f\_{end}=0\\]

Midpoint: \\[f'\_{mid}=0\\]

From the midpoint constraint:

\\[C=f\_{mid}\times(L-f\_{mid})\\]

## Polynomial

We will choose the interval:
\\[-1/2\leq s \leq 1/2\\]

which makes the midpoint \\(s=0\\).

The curve is symmetric about the midpoint, i.e. an __even__ function so:

\\[f(s)=a\_0 + a\_2 s\^2 + a\_4 s\^4 + \cdots\\]
\\[C=a\_0\times(L-a\_0)\\]

\\[f'(s)=2 a\_2 s + 4 a\_4 s\^3 +6 a\_6 s\^5 + \cdots\\]

### Constraints

\\[f(.5)=0\quad\text{endpoint}\\]
\\[0\leq f \lt L\quad\text{physical limitation}\\]
\\[f'(0)=0, \quad f'(s)\ne0 \\,\text{if}\\, s\ne0\quad \text{single maximum}\\]
\\[-1\leq f' \leq 1\quad \text{phyisical limitation}\\]
\\[f'(\pm.5)=\mp 1\quad\text{from equation}\\]

From the analysis [seen earlier](./extremal.md) at the midpoint:

\\[0\lt f\_{mid}\lt L/2\quad\rightarrow\quad 0\lt a\_0\lt L/2\\]


## Solution strategy

* Substitute the equation for \\(f,f',C\\) into the Governing equation
* Rearrange into a polynomial in \\(s\\)
* Set each coefficient to 0, solving for \\(a\_i,\\quad i>0\\) in terms of \\(a\_0,L\\)
* Solve \\(a\_0\\) for endpoint constraint \\(f(.5)=0\\)

We will use [Maxima](https://maxima.sourceforge.io/) to do the calculations. The actual scripts can be seen in `js/polyX.mac` in the [source code repository](https://github.com/alfille/HotApplePi).

### Naive approach

Using `poly1.mac`

```
        2 a0 - L
a  = - ------------- 
 2     2 a0 (a0 - L)
                     2             2
     (2 a0 - L) (6 a0  - 6 L a0 + L )
a  = -------------------------------- 
 4                3         3
             24 a0  (a0 - L)
                         4           3        2   2       3       4
       (2 a0 - L) (108 a0  - 216 L a0  + 138 L  a0  - 30 L  a0 + L )
a  = - ------------------------------------------------------------- 
 6                                 5         5
                             720 a0  (a0 - L)
                         6             5          2   4         3   3
a  = ((2 a0 - L) (3528 a0  - 10584 L a0  + 11952 L  a0  - 6264 L  a0
 8
                                4   2        5       6            7         7
                        + 1494 L  a0  - 126 L  a0 + L ))/(40320 a0  (a0 - L) ) 
                              8              7            2   6
a   = - ((2 a0 - L) (184464 a0  - 737856 L a0  + 1199664 L  a0
 10
            3   5           4   4           5   3          6   2        7
 - 1016496 L  a0  + 476820 L  a0  - 120312 L  a0  + 14226 L  a0  - 510 L  a0
    8              9         9
 + L ))/(3628800 a0  (a0 - L) ) 
 ```
 As can be seen, there is a consistent
 
 \\[\frac{(-1)\^{i/2} (2 a\_0 - L)}{i!\\,a\_0\^{i-1} (a\_0-L)\^{i-1}}\\]
 
 factor in each term, times a polynomial in \\(a\_0,L\\)
 
 ### Second function
 
 Define a second related function \\(g\\) and constant \\(b\_0\\):
 \\[g(s)=L-f(s)\quad\text{and}\quad b\_0 = L-a\_0\\]
 
 Then
 
 \\[g=L-a\_0-a\_2 s\^2-a\_4 s\^4 - \cdots=b\_0-a\_2 s\^2-a\_4 s\^4 - \cdots\\]
 \\[g' = -f'\\]
 
 And the Governing equation:
\\[f\^2 g\^2 - a\_0\^2 b\_0\^2 (1+f'g')=0\\]
is symmetric in \\(a\_0,b\_0\\) and \\(f,g\\)
 
Working through (`poly5.mac`):

\\[a\_i=\frac{(-1)\^{i/2} (a\_0+b\_0)}{i!\\,a\_0\^{i-1}b\_0\^{i-1}}P\_i,\quad i=2,4,\cdots\\]
for polynomial \\(P\_i(a\_0,b\_0)\\) 

\\[P\_2=1\\]
\\[P\_4=b\_0\^2+4\\,a\_0 b\_0+a\_0\^2\\]
\\[P\_6=b\_0\^4+26\\,a\_0 b\_0\^3+54\\,a\_0\^2b\_0\^2+26\\,a\_0\^3b\_0+a\_0\^4\\]
\\[P\_8=b\_0\^6+120\\,a\_0 b\_0\^5+879\\,a\_0\^2b\_0\^4+1528\\,a\_0\^3b\_0\^3+879\\,a\_0\^4b\_0\^2+120\\,a\_0\^5b\_0+a\_0\^6\\]

Note that all the terms are:

* positive
* of the same order \\(i-2\\)
* completely symmetric in \\(a\_0,b\_0\\)

### Asymptotic -- Large L

For Large L:

\\[b\_0 = L-a\_0 \gg a\_0\\]
\\[P\_i \approx b\_0\^{i-2},\quad (a\_0+b\_0)\approx b\_0\\] 

So 

\\[a\_i=\frac{(-1)\^{i/2} (a\_0+b\_0)}{i!\\,a\_0\^{i-1}b\_0\^{i-1}}P\_i=\frac{(-1)\^{i/2}}{i!\\,a\_0\^{i-1}},\quad i=2,4,\cdots\\]
\\[f(s)=a\_0\lbrace 1 - \frac{s\^2}{2!\\,a\_0\^2}+ \frac{s\^4}{4!\\,a\_0\^4}- \frac{s\^6}{6!\\,a\_0\^6}\pm\cdots\rbrace=a\_0\cos(\frac{s}{a\_0})\\]
Endpoint constraint: \\(a\_0=1/\pi\\)

This matches our [earlier analysis](./long.md).

### Asymptotic -- Small L

Since \\(f\_{max}=f(0)=a\leq L/2\\), let:

\\[a\_0=b\_0=L/2\\]
\\[a\_i=\frac{(-1)\^{i/2}L}{i!\\,L^{2i-2}/2\^{2i-2}}P\_i(L/2,L/2)=\frac{(-1)\^{i/2} 2\^{2i-2}}{i!\\,L^{2i-3}}P\_i(L/2,L/2)\\]
\\[a\_i=\frac{(-1)\^{i/2} 2\^{2i-2}}{i!\\,L^{2i-3}}\frac{L\^{i-2}}{2\^{i-2}}p\_i=\frac{(-1)\^{i/2} 2\^i}{i!\\,L^{i-1}}p\_i\\]

Where 
\\[p\_i=P\_i(1,1)=\text{sum of polynomial coefficients}\\]

\\[{{2\^{ 2 }}\over{ 2 !}}p( 2 )= 4 \\] 
\\[{{2\^{ 4 }}\over{ 4 !}}p( 4 )= 4 \\] 
\\[{{2\^{ 6 }}\over{ 6 !}}p( 6 )= {{48}\over{5}} \\] 
\\[{{2\^{ 8 }}\over{ 8 !}}p( 8 )= {{112}\over{5}} \\] 
\\[{{2\^{ 10 }}\over{ 10 !}}p( 10 )= {{3904}\over{75}} \\] 
\\[{{2\^{ 12 }}\over{ 12 !}}p( 12 )= {{9088}\over{75}} \\] 
\\[{{2\^{ 14 }}\over{ 14 !}}p( 14 )= {{91648}\over{325}} \\] 
\\[{{2\^{ 16 }}\over{ 16 !}}p( 16 )= {{3199232}\over{4875}} \\] 
\\[{{2\^{ 18 }}\over{ 18 !}}p( 18 )= {{379710464}\over{248625}} \\] 
\\[{{2\^{ 20 }}\over{ 20 !}}p( 20 )= {{1472776192}\over{414375}} \\] 

![](images/SmallLCoeff.png)

Unfortunately, this is unbounded for \\(L<5\\) which violates our small L requirement, so \\(a\_0\ll L/2\\)
		
### Coefficients:
Just with coefficients:
\\[P\_2=\lbrace 1 \rbrace\\]
\\[P\_4=\lbrace 1, 4, 1 \rbrace\\]
\\[P\_6=\lbrace 1, 26, 54, 26, 1 \rbrace\\]
\\[P\_8=\lbrace 1, 120, 879, 1528, 879, 120, 1 \rbrace\\]
\\[P\_{10}=\lbrace 1, 502, 10684, 45610, 70870, 45610, 10684, 502, 1 \rbrace\\]
\\[P\_{12}=\lbrace 1, 2036, 112413, 1069128, 3430194, 4942920, 3430194, 1069128, 1112413, 2036, 1 \rbrace\\]
\\[P\_{14}=\lbrace 1, 8178, 1097490, 21859178, 132559119, 353250756, 482923068, 353250756, \cdots \rbrace\\]

### Factors
Factoring the coefficients to look for a pattern (only the first through middle term, since the remaining terms are redundant)

\\[P( 2 )= \left[ 1 \right]  \\] 
\\[P( 4 )= \left[ 1 , 2\^2 \right]  \\] 
\\[P( 6 )= \left[ 1 , 2 13 , 2 3\^3 \right]  \\] 
\\[P( 8 )= \left[ 1 , 2\^3 3 5 , 3 293 , 2\^3 191 \right]  \\] 
\\[P( 10 )= \left[ 1 , 2 251 , 2\^2 2671 , 2 5 4561 , 2 5 19 373 \right]  \\] 
\\[P( 12 )= \left[ 1 , 2\^2 509 , 3 7 53 101 , 2\^3 3\^2 31 479 , 2 3 571699 , 2\^3 3 5 17 2423 \right]  \\] 
\\[P( 14 )= \left[ 1 , 2 3 29 47 , 2 3 5 36583 , 2 11 17 211 277 , 3\^3 7 11 63761 , 2\^2 3\^2 61 160861 , 2\^2 3 53 759313 \right]  \\] 
\\[P( 16 )= \left[ 1 , 2\^4 23 89 , 17 606059 , 2\^3 6673 7669 , 4999 900719 , 2\^4 5 256413739 , 3 73 218562689 , 2\^4 3 1310653853 \right]  \\] 
\\[P( 18 )= \left[ 1 , 2 7 11 23 37 , 2\^3 3 31 127363 , 2 19\^2 59 170047 , 2\^2 13 17 158575279 , 2 3 5 7 7207 694609 , 2\^3 62533 7826837 , 2 5 826648709417 , 2 3\^2 251 6961 335089 \right]  \\] 
\\[P( 20 )= \left[ 1 , 2\^2 3\^2 14563 , 3\^2 95806561 , 2\^3 3 79 349 186707 , 2\^2 3\^3 7 17 319009081 , 2\^6 3\^3 5 11 1171 444449 , 2\^2 3 5711 7523 550439 , 2\^3 3\^2 5113 2468163637 , 2 3\^2 5 7\^2 13 109 157 769 2351 , 2\^3 23 13883 863904329 \right]  \\] 
\\[P( 22 )= \left[ 1 , 2 5 7 29959 , 2 5 7\^5 29 1601 , 2 3 5 13 12197 432659 , 3 5 11 694614020329 , 2\^3 3 11 867301 9541669 , 2\^3 3 5 149 62743 16852873 , 2\^3 3 5\^2 73\^2 191 145482737 , 2 3 5 719989 11699561099 , 2\^2 5 53 313 1395846560299 , 2\^2 11 10949 1172460652819 \right]  \\] 
\\[P( 24 )= \left[ 1 , 2\^3 1048573 , 3\^2 7 17 29 281 8069 , 2\^3 5 7 29 5569 746869 , 5 139 173 971 1063 24989 , 2\^3 3\^3 2789 152614929799 , 3 394199179006379623 , 2\^5 3 23 83 1063 41039512753 , 2 3\^3 5\^2 101 1217 5987 32370017 , 2\^4 5 158339527 6562982579 , 2 37 281 5119 138197 9831397 , 2\^4 3\^2 443 2719651697308163 \right]  \\] 
\\[P( 26 )= \left[ 1 , 2 3 53 105517 , 2\^2 3 67 283 2789327 , 2 274488301788773 , 2 3 2063 139753 47390309 , 2 3 311 70957 122231 230303 , 2\^2 23 29 34739 54133 14033861 , 2 3\^2 11 29 65514083 1796039299 , 3\^2 139 981419 3071424407119 , 2\^2 1153 9689 299492311469327 , 2\^3 3 17 311 251964622019808473 , 2\^2 3 151 313 1008913 93042199973 , 2\^2 13 47 193 677 3019 3083 21189017 \right]  \\] 
\\[P( 28 )= \left[ 1 , 2\^2 5\^2 1342177 , 677 5903 1430239 , 2\^3 13\^2 139 47198777831 , 2 1065660181728394787 , 2\^3 17 47 619621 37070236793 , 2 2015075053060512888443 , 2\^3 571 34603 343738170958601 , 61 58262020163 116885414021 , 2\^2 7 1229 41777 185993 7434892877 , 733 208739 30266059 1373987843 , 2\^4 11 13 173 1193149 30117072674011 , 2\^2 11 229 293 373 20723056385060599 , 2\^4 1667033479239526865177197 \right]  \\] 
\\[P( 30 )= \left[ 1 , 2 61 823 5347 , 2 3 89 96362828911 , 2 3 5 37 128627977145071 , 3 5 7 53 4513 4603 10753 44053 , 2\^2 3 11\^2 2382307 1635491353459 , 2\^2 3 37 55640419 9045667125541 , 2\^2 3 1511 886541 261074304223963 , 3 43 337539599390321201035369 , 2 3\^2 5 7 11 41 59 1663 9955736246072887 , 2 3 195046845963327103314498649 , 2 3 7 31\^2 173 491753722553781803287 , 3 13 269 691313646151292715191873 , 2\^3 3 991 4801 11257 2196401 3991233397 , 2\^3 3 5 547 198572582164206376212979 \right]  \\] 
\\[P( 32 )= \left[ 1 , 2\^5 3 2731 8191 , 3 467 1163 284277121 , 2\^3 1439 7691 25896813829 , 3\^2 103 211 7133934881527457 , 2\^6 3\^2 137 617 4402510070777579 , 3\^3 5\^2 17 1052589056021189354389 , 2\^4 3\^2 7 23 2333 5796969653902808813 , 3\^2 486875932457875290547566389 , 2\^7 3 5 521 1140721 3888967 8308363069 , 3\^3 5 8161 504047 364472046913890271 , 2\^3 3\^2 7 17 138113 69047177 9391202457121 , 3 5 7 317 62798650235940077839490197 , 2\^5 3\^2 5 7\^2 59573953256243446597817171 , 3\^2 1500613 397654297 1182529414603223 , 2\^5 3\^3 31 1613 168499346454521221834151 \right]  \\]
\\[P( 34 )= \left[ 1 , 2 4294967279 , 2\^4 5 222317 234407431 , 2 179 66457 1545436350023 , 2\^3 13 339886663067064310801 , 2 41 151 647589940892496044141 , 2\^4 3\^2 137 32420741611090160065057 , 2 3\^2 151 8384286018198934330556527 , 2\^2 3\^2 3613 104119 31471935591629926181 , 2 3 37626881 20823945219576580299377 , 2\^4 3 5\^3 61 433 1097 2713 70625745586951913 , 2 3 11\^2 103 779003 2769688908724145237927 , 2\^3 3 8071859 30845819969 93476604058163 , 2 3 7 11\^2 59 179 3887080461227 6839385195529 , 2\^4 3 691 2486383 61845067 538986508376713 , 2 3\^2 5 47 89 26548321 405441577894217870711 , 2 3\^2 47 15709368287 346705308138884447899 \right] \\] 
\\[P( 36 )= \left[ 1 , 2\^2 8589934583 , 3 479 26111684476789 , 2\^3 7 1427 27983 263438421221 , 2\^3 11 235349 43059884872460623 , 2\^4 3 6188822685489597685132687 , 2\^3 7\^2 41 131 15824917995291581476739 , 2\^3 2909 7753 379081 8927833 2650921769 , 2\^2 3\^4 4350200980453 28578981786795091 , 2\^4 3 7 13 1361 2091703 5472629 8510371523861 , 2\^2 3 5 89 239 353 577 809 2797 8945208032620427 , 2\^3 3\^2 5 67 251 5333100717397706279971183739 , 2\^3 3 17 31 101341 536791 84934973 2405058239341 , 2\^4 3 71 99178571 1330870995525919602875509 , 2\^3 3\^2 5 37 15061 49747 108841567854317326822481 , 2\^3 3 7\^2 277 1163 9881857 538239699565906803401 , 2 3 29473 1314558229 12501873734804944662461 , 2\^3 3\^4 378829924777 13366182029946943317557 \right]  \\] 
\\[P( 38 )= \left[ 1 , 2 3\^2 3797 2010929 , 2 3\^3 11 16974829 33492647 , 2 3 17 947 3469 28151849390521 , 3\^2 23 563 15963763 12059177942527 , 2\^4 3\^2 13\^2 37 7867 41627 37051135052497 , 2\^4 3 6277 17341 327885422269693509427 , 2\^4 3\^3 53 379 88817 146387037244618516249 , 2\^2 3\^2 11 331 162907 16607951 10476192430974409 , 2\^3 11\^2 59 3793 319795055936288686505007761 , 2\^3 3\^3 7 521 863 3541 9157 36415462480626848951 , 2\^3 3\^4 61 8002759 19602218729138973076679897 , 2\^2 3\^2 13 17\^2 123224360136043 2019998386679502679 , 2\^4 3\^3 13 43 52627 10515138130543182597511262237 , 2\^4 3\^3 571 82829977 19543352024512604306336239 , 2\^4 3\^2 600177388343574961 10615928146359582467 , 2 3\^4 30341 6582727 50863496032819940770212173 , 2\^2 3\^3 20981 24470940113351 41980308426977377031 , 2\^2 3 5 19 43 42181 1262934124607378702891054070619 \right]  \\] 
\\[P( 40 )= \left[ 1 , 2\^3 68719476731 , 692431 4389456096049 , 2\^3 3 329391091 19101699179887 , 3 11 17 89 35983 71699 4372952433419 , 2\^3 3 11 19\^2 3583 1036751 1487873 758651051 , 3 127 13147 264167 65881749656567547713 , 2\^6 3 359 47699 319441 7370692853988337033 , 2\^2 3 41 15629 37783 1155233546881504852482697 , 2\^5 5 199 1506885795059 168396597219388092259 , 2\^2 13 37 360160439 171534888729017982147371209 , 2\^5 11 7829587 182192533 10503014789 218060226721 , 2\^2 3\^2 97 1033 137131 875627 92164543 193864677172037 , 2\^5 3\^2 19\^2 389 6217 150353486719928279049910267483 , 2\^2 3\^2 3845425297570058766688692110870810770213 , 2\^6 3\^2 29 41 67 109 163 477513764270107556389211531489 , 2 3\^2 5 7 2087 195689101 1471688711 2260088667998323361 , 2\^4 3\^2 131 257 6022229 400341127 127438564109637639301 , 2 3 17 43 12647 18913 1973456780361152410373421273079 , 2\^4 3 7 1231 171992423 32461455106048277276671288297 \right] \\] 
